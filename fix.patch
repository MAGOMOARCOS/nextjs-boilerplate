diff --git a/components/WaitlistForm.tsx b/components/WaitlistForm.tsx
index 1111111..2222222 100644
--- a/components/WaitlistForm.tsx
+++ b/components/WaitlistForm.tsx
@@ -1,3 +1,5 @@
+'use client';
+
 import React, { useState } from 'react';
 
 export default function WaitlistForm() {
diff --git a/app/api/waitlist/route.ts b/app/api/waitlist/route.ts
index 3333333..4444444 100644
--- a/app/api/waitlist/route.ts
+++ b/app/api/waitlist/route.ts
@@ -1,93 +1,104 @@
 import { NextResponse } from 'next/server';
 import { supabaseServer } from '../../lib/supabaseServer';
 
 type Body = {
   name?: string;
   email?: string;
 };
 
 function isValidEmail(email: string) {
   return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
 }
 
 export async function POST(request: Request) {
+  // IMPORTANT: keep parsed values outside try so we can reuse them in catch
+  let rawEmail = '';
+  let name: string | null = null;
+
   try {
     const body: Body = await request.json().catch(() => ({} as Body));
-    const rawEmail = (body.email || '').trim();
-    const name = (body.name || '').trim() || null;
+    rawEmail = (body.email || '').trim();
+    name = (body.name || '').trim() || null;
 
     if (!rawEmail || !isValidEmail(rawEmail)) {
       return NextResponse.json(
         { ok: false, error: 'Invalid email' },
         { status: 400 }
       );
     }
 
     // Primary attempt: call the idempotent RPC (recommended)
     try {
       const rpc = await supabaseServer
         .rpc('waitlist_add_idempotent', { p_name: name, p_email: rawEmail })
         .throwOnError();
 
       const rows = rpc.data as Array<{ status: string; waitlist_id: string }>;
       const row = rows?.[0] ?? null;
 
       if (row) {
         return NextResponse.json({
           ok: true,
           status: row.status === 'inserted' ? 'inserted' : 'exists',
           id: row.waitlist_id ?? null,
         });
       } else {
         return NextResponse.json({ ok: true, status: 'unknown', id: null });
       }
     } catch (rpcError: any) {
       // Fallback to direct insert below
     }
 
     // Fallback: try direct insert and handle unique_violation
     const insert = await supabaseServer
       .from('waitlist')
       .insert({ name, email: rawEmail })
       .select('id')
       .throwOnError()
       .maybeSingle();
 
     if (insert.data && (insert.data as any).id) {
       return NextResponse.json({ ok: true, status: 'inserted', id: (insert.data as any).id });
     }
 
     const existing = await supabaseServer
       .from('waitlist')
       .select('id')
       .ilike('email', rawEmail)
       .limit(1)
       .maybeSingle();
 
     if (existing.data && (existing.data as any).id) {
       return NextResponse.json({ ok: true, status: 'exists', id: (existing.data as any).id });
     }
 
     return NextResponse.json({ ok: false, error: 'Could not add to waitlist' }, { status: 500 });
   } catch (err: any) {
     const pgCode = err?.code ?? err?.error?.code ?? null;
 
     if (pgCode === '23505') {
-      try {
-        const json = await request.json().catch(() => ({} as Body));
-        const rawEmail = (json.email || '').trim();
-        const existing = await supabaseServer
-          .from('waitlist')
-          .select('id')
-          .ilike('email', rawEmail)
-          .limit(1)
-          .maybeSingle();
-
-        if (existing.data && (existing.data as any).id) {
-          return NextResponse.json({ ok: true, status: 'exists', id: (existing.data as any).id });
-        }
-      } catch (_e) {}
-      return NextResponse.json({ ok: true, status: 'exists', id: null });
+      // Do NOT call request.json() again (body stream is already consumed)
+      if (rawEmail) {
+        try {
+          const existing = await supabaseServer
+            .from('waitlist')
+            .select('id')
+            .ilike('email', rawEmail)
+            .limit(1)
+            .maybeSingle();
+
+          if (existing.data && (existing.data as any).id) {
+            return NextResponse.json({ ok: true, status: 'exists', id: (existing.data as any).id });
+          }
+        } catch (_e) {}
+      }
+      return NextResponse.json({ ok: true, status: 'exists', id: null });
     }
 
+    console.error('[waitlist] POST error', err);
     return NextResponse.json({ ok: false, error: 'Unexpected error' }, { status: 500 });
   }
 }
